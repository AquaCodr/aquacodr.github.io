# 区间估计

好的，现在我们进入**区间估计**。这是数理统计中“用样本推断总体”的第二类核心问题，比点估计提供了更多信息——不仅给出一个估计值，还给出了这个估计的精度和可靠程度。

---

## **一、 核心逻辑与知识地图**

**核心思想：** 构造一个随机区间 `[θ̂_L, θ̂_U]`，使得该区间以一定的概率（置信水平）覆盖未知参数的真值。

**逻辑主线：**
**待估参数 θ** → **寻找关键统计量（含 θ 且分布已知）** → **根据分布和置信度确定分位数** → **将不等式变形为关于 θ 的区间** → **得到置信区间**

**关键区别：**

- **点估计**：给出一个数 `θ̂`。
- **区间估计**：给出一个区间 `(θ̂_L, θ̂_U)` 和置信水平 `1-α`。

---

## **二、 核心知识点精讲与易错点**

### **1. 基本概念**

- **置信区间**：设 `θ` 为总体参数，`(θ̂_L, θ̂_U)` 是由样本确定的两个统计量，满足：
    \[
    P( \thetâ_L < \theta < \thetâ_U ) = 1 - \alpha
    \]
    则称 `(θ̂_L, θ̂_U)` 是 `θ` 的置信水平为 `1-α` 的**置信区间**。
- **置信水平 `1-α`**：区间包含真值的概率。通常取 `0.90`, `0.95`, `0.99`。`α` 称为**显著性水平**，是区间不包含真值的风险。
- **精确理解**：`θ` 是固定的未知常数，区间是随机的。置信水平 `1-α` 的含义是：**在大量重复抽样下，用该方法构造的区间中，有大约 `(1-α)×100%` 的区间包含真值 `θ`**。而不是“`θ` 有 `1-α` 的概率落在这个区间里”（后者是贝叶斯观点）。

### **2. 构造置信区间的一般步骤（重中之重）**

这是解决任何区间估计问题的**通用模板**：

1.  **选择统计量**：找一个包含待估参数 `θ` 和样本的统计量 `G = G(X₁,…,Xₙ; θ)`，要求其分布已知且**不依赖于任何其他未知参数**。
2.  **确定分布**：根据抽样分布理论，确定 `G` 的精确分布或渐近分布。
3.  **确定分位数**：对给定的置信水平 `1-α`，找到常数 `a`, `b`，使得
    \[
    P(a < G < b) = 1 - \alpha。
    \]
    通常取对称或等尾的分位数，即 `P(G ≤ a) = P(G ≥ b) = α/2`。
4.  **不等式变形**：将事件 `{a < G < b}` 等价地转化为关于 `θ` 的不等式 `{θ̂_L < θ < θ̂_U}`。
5.  **写出区间**：置信区间为 `(θ̂_L, θ̂_U)`。

### **3. 单个正态总体参数的置信区间（必须背熟）**

设总体 `X ~ N(μ, σ²)`，样本 `X₁,…,Xₙ`，样本均值 `X̄`，样本方差 `S²`。

| 待估参数    | 条件        | 关键统计量及其分布            | `1-α` 置信区间                                       |
| :---------- | :---------- | :---------------------------- | :--------------------------------------------------- |
| **均值 μ**  | **σ² 已知** | `Z = (X̄ - μ)/(σ/√n) ~ N(0,1)` | `X̄ ± z_{α/2} · σ/√n`                                 |
| **均值 μ**  | **σ² 未知** | `T = (X̄ - μ)/(S/√n) ~ t(n-1)` | `X̄ ± t_{α/2}(n-1) · S/√n`                            |
| **方差 σ²** | **μ 未知**  | `χ² = (n-1)S²/σ² ~ χ²(n-1)`   | `( (n-1)S²/χ²_{α/2}(n-1), (n-1)S²/χ²_{1-α/2}(n-1) )` |
| **方差 σ²** | **μ 已知**  | `χ² = Σ(X_i-μ)²/σ² ~ χ²(n)`   | `( Σ(X_i-μ)²/χ²_{α/2}(n), Σ(X_i-μ)²/χ²_{1-α/2}(n) )` |

**重要说明**：

- `z_{α/2}` 是标准正态分布的上侧 `α/2` 分位数，满足 `P(Z > z_{α/2}) = α/2`， `P(|Z| > z_{α/2}) = α`。
- `t_{α/2}(n-1)` 是 `t(n-1)` 分布的上侧 `α/2` 分位数。
- `χ²_{α/2}(n-1)` 和 `χ²_{1-α/2}(n-1)` 是 `χ²(n-1)` 分布的上侧分位数。
- **均值区间对称，方差区间不对称**。

### **4. 两个正态总体参数的置信区间**

设 `X ~ N(μ₁, σ₁²)`， `Y ~ N(μ₂, σ₂²)`，样本相互独立，样本量分别为 `n₁`, `n₂`，样本均值 `X̄`, `Ȳ`，样本方差 `S₁²`, `S₂²`。

| 待估参数           | 条件                | 关键统计量及其分布                                           | `1-α` 置信区间                                               |
| :----------------- | :------------------ | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **均值差 μ₁-μ₂**   | **σ₁², σ₂² 已知**   | `Z = [(X̄-Ȳ)-(μ₁-μ₂)]/√(σ₁²/n₁+σ₂²/n₂) ~ N(0,1)`              | `(X̄-Ȳ) ± z_{α/2}·√(σ₁²/n₁+σ₂²/n₂)`                           |
| **均值差 μ₁-μ₂**   | **σ₁²=σ₂²=σ² 未知** | `T = [(X̄-Ȳ)-(μ₁-μ₂)]/(S_p√(1/n₁+1/n₂)) ~ t(n₁+n₂-2)`<br> `S_p² = [(n₁-1)S₁²+(n₂-1)S₂²]/(n₁+n₂-2)` | `(X̄-Ȳ) ± t_{α/2}(n₁+n₂-2)·S_p√(1/n₁+1/n₂)`                   |
| **方差比 σ₁²/σ₂²** | **μ₁, μ₂ 未知**     | `F = (S₁²/σ₁²)/(S₂²/σ₂²) ~ F(n₁-1, n₂-1)`                    | `( S₁²/S₂² · 1/F_{α/2}(n₁-1,n₂-1), S₁²/S₂² · F_{α/2}(n₂-1,n₁-1) )`<br>或利用 `F_{1-α/2}(n₁-1,n₂-1)=1/F_{α/2}(n₂-1,n₁-1)` |

### **5. 非正态总体或大样本情形**

- **均值 μ 的区间估计（大样本）**：由中心极限定理，当 `n` 较大时，`(X̄ - μ)/(S/√n) ≈ N(0,1)`。因此 `μ` 的近似 `1-α` 置信区间为：
    \[
    \overline{X} \pm z_{\alpha/2} \cdot \frac{S}{\sqrt{n}}
    \]
    （与正态总体 `σ²` 未知时形式相同，但这里是近似分布）。
- **比例 p 的区间估计（0-1分布）**：设总体 `X ~ B(1, p)`，样本 `X₁,…,Xₙ`，样本比例 `p̂ = X̄`。当 `n` 较大时，由中心极限定理，
    \[
    \frac{\hat{p} - p}{\sqrt{\hat{p}(1-\hat{p})/n}} \stackrel{\text{近似}}{\sim} N(0,1)。
    \]
    `p` 的近似 `1-α` 置信区间为：
    \[
    \hat{p} \pm z_{\alpha/2} \cdot \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}。
    \]
    （更精确的可用 `p` 代替 `p̂` 在根号内，但需解二次方程。）

---

## **三、 重点题型与解题套路**

### **题型1：直接套用公式（正态总体）**

- **识别**：明确总体分布、待估参数、已知条件（方差是否已知？是否两个总体？）。
- **选择公式**：对照上面的表格选择正确的统计量和区间公式。
- **查表计算**：正确查 `z`, `t`, `χ²`, `F` 分位数表。
- **易错点**：
    - 方差已知用 `z`，方差未知用 `t`。
    - 方差区间不对称，查 `χ²_{α/2}` 和 `χ²_{1-α/2}`。
    - 两个总体方差比区间，注意 `F` 分位数的顺序和倒数关系。

### **题型2：非正态总体大样本近似**

- **识别**：总体分布非正态，但样本量 `n` 大（通常 `n≥30`）。
- **方法**：利用中心极限定理，用 `z` 统计量构造近似置信区间。
- **注意**：对于比例 `p`，要确保 `np̂` 和 `n(1-p̂)` 不过小（如都大于5）。

### **题型3：需要自行构造统计量的综合题**

- **步骤**：严格遵循“构造置信区间的一般步骤”。
- **关键**：找到一个分布已知的统计量 `G(X,θ)`。
- **示例**：估计指数分布 `Exp(λ)` 的参数 `λ`。
    - 已知 `ΣX_i ~ Gamma(n, λ)`，或 `2λΣX_i ~ χ²(2n)`。
    - 取 `G = 2λΣX_i ~ χ²(2n)`。
    - 由 `P(χ²_{1-α/2}(2n) < 2λΣX_i < χ²_{α/2}(2n)) = 1-α`，解出 `λ` 的区间。

### **题型4：置信区间与样本量的关系**

- 区间长度 `L = 2 × 分位数 × (标准误)`。
- 对于均值估计（方差已知时），`L = 2 z_{α/2} σ/√n`。
- 给定置信水平 `1-α` 和允许误差 `d`（半长），可解出所需样本量：
    \[
    n \ge \left( \frac{z_{\alpha/2} \cdot \sigma}{d} \right)^2。
    \]
    （若 `σ` 未知，可用样本标准差 `S` 预估计。）

---

## **四、 终极查漏清单**

1.  **概念**：如何理解置信水平 `1-α`？能说“参数有 95% 的概率落在区间内”吗？
2.  **公式**：写出单个正态总体在方差未知时，均值 `μ` 的 `1-α` 置信区间公式。
3.  **查表**：`t_{0.025}(10)`, `χ²_{0.05}(15)`, `F_{0.05}(5,10)` 分别表示什么？如何查表？
4.  **比较**：在相同样本下，`σ` 已知和 `σ` 未知时，`μ` 的置信区间哪个更宽？为什么？（`σ` 未知时更宽，因为用 `t` 分布的分位数比 `z` 大，且 `S` 代替 `σ` 有额外不确定性。）
5.  **计算**：从正态总体中抽取 `n=16` 的样本，测得 `X̄=5.2`， `S=1.5`。求 `μ` 的 95% 置信区间。
    - （解：`α=0.05`， `t_{0.025}(15)=2.131`，区间：`5.2 ± 2.131×1.5/4 = 5.2 ± 0.799`，即 `(4.401, 5.999)`。）

**重要练习**：
设总体 `X ~ N(μ, σ²)`， `σ²` 未知。现有样本容量 `n=9`，测得 `Σx_i = 45`， `Σx_i² = 285`。

1.  求 `μ` 的 95% 置信区间。
2.  求 `σ²` 的 90% 置信区间。

**建议**：现在，请你合上眼，在纸上默写出**单个正态总体均值与方差的三个置信区间公式（σ已知、σ未知；μ已知、μ未知）**，以及**构造置信区间的五步法**。然后，找一道涉及两个总体均值差或方差比的题目，完整地做一遍。这是区间估计部分的核心技能。