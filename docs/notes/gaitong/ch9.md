# 假设检验

好的，我们进入**假设检验**，这是统计推断的另一核心支柱。如果说估计是“猜参数是多少”，那么检验就是“判断一个关于参数的假设是否成立”。

---

## **一、 核心逻辑与知识地图**

**核心思想：** 利用小概率反证法，对总体参数或分布的某个假设做出拒绝或不拒绝的决策。

**逻辑主线：**
**提出原假设与备择假设** → **构造检验统计量（在 H₀ 下分布已知）** → **确定拒绝域（显著性水平 α）** → **根据样本计算并决策**  
**或**：**计算 P 值** → **与 α 比较并决策**

**两大框架：**

1.  **显著性检验（临界值法）**：基于拒绝域。
2.  **P 值检验**：基于“更极端”的概率。

---

## **二、 核心知识点精讲与易错点**

### **1. 基本概念**

- **原假设（H₀）**：通常表示“无效果”、“无差异”、“维持现状”。是我们要**检验**的假设。
- **备择假设（H₁）**：通常表示“有效果”、“有差异”、“研究者想证明的”。是拒绝 H₀ 时接受的假设。
- **两类错误**：
    - **第一类错误（弃真）**：H₀ 为真时拒绝 H₀。概率记为 **α**（显著性水平）。
    - **第二类错误（取伪）**：H₀ 为假时未拒绝 H₀。概率记为 **β**。
- **检验的功效**：`1 - β`，即 H₀ 为假时正确拒绝 H₀ 的概率。
- **显著性水平 α**：事先设定的允许犯第一类错误的最大概率。通常取 0.05, 0.01 等。

### **2. 假设检验的基本步骤（通用流程）**

1.  **提出假设**：根据问题设立 H₀ 和 H₁（注意单侧/双侧）。
2.  **构造检验统计量**：在 H₀ 成立的假定下，找一个包含样本信息和待检参数、且分布已知的统计量。
3.  **确定拒绝域**：给定 α，根据 H₁ 的方向（单侧/双侧），查分布的分位数，确定拒绝 H₀ 的统计量取值范围。
4.  **计算**：根据样本数据计算检验统计量的**观测值**。
5.  **决策**：
    - **临界值法**：若观测值落入拒绝域，则拒绝 H₀；否则不拒绝。
    - **P 值法**：计算 P 值，若 P 值 ≤ α，则拒绝 H₀；否则不拒绝。

### **3. P 值（P-value）**

- **定义**：在原假设 H₀ 成立的前提下，出现当前样本观测结果或**更极端结果**的概率。
- **直观理解**：P 值越小，说明当前样本数据与 H₀ 矛盾的程度越大。
- **决策规则**：若 **P 值 ≤ α**，则拒绝 H₀；若 **P 值 > α**，则不拒绝 H₀。
- **优点**：比“拒绝/不拒绝”提供了更多信息（矛盾的强度），并且便于在不同 α 水平下做决策。
- **计算**：根据检验统计量的分布和 H₁ 的方向计算尾部概率。

### **4. 单个正态总体参数的假设检验（必须背熟）**

设总体 `X ~ N(μ, σ²)`，样本 `X₁,…,Xₙ`。

| 检验对象    | 条件    | H₀       | 检验统计量（H₀下）             | 拒绝域（显著性水平 α）                                       |
| :---------- | :------ | :------- | :----------------------------- | :----------------------------------------------------------- |
| **均值 μ**  | σ² 已知 | μ = μ₀   | `Z = (X̄ - μ₀)/(σ/√n) ~ N(0,1)` | 双侧：`|Z| ≥ z_{α/2}`<br>右侧：`Z ≥ z_α`<br>左侧：`Z ≤ -z_α` |
| **均值 μ**  | σ² 未知 | μ = μ₀   | `T = (X̄ - μ₀)/(S/√n) ~ t(n-1)` | 双侧：`|T| ≥ t_{α/2}(n-1)`<br>右侧：`T ≥ t_α(n-1)`<br>左侧：`T ≤ -t_α(n-1)` |
| **方差 σ²** | μ 未知  | σ² = σ₀² | `χ² = (n-1)S²/σ₀² ~ χ²(n-1)`   | 双侧：`χ² ≤ χ²_{1-α/2}(n-1)` 或 `χ² ≥ χ²_{α/2}(n-1)`<br>右侧：`χ² ≥ χ²_α(n-1)`<br>左侧：`χ² ≤ χ²_{1-α}(n-1)` |

**注意**：

- 方差检验的拒绝域是**不对称**的，且左侧检验拒绝域在左侧尾部。
- 对于方差检验，备择假设 `H₁: σ² > σ₀²` 对应右侧检验，拒绝域在右侧。

### **5. 两个正态总体参数的假设检验**

设 `X ~ N(μ₁, σ₁²)`， `Y ~ N(μ₂, σ₂²)`，样本独立。

| 检验对象           | 条件            | H₀        | 检验统计量（H₀下）                                           | 分布          |
| :----------------- | :-------------- | :-------- | :----------------------------------------------------------- | :------------ |
| **均值差 μ₁-μ₂**   | σ₁², σ₂² 已知   | μ₁ = μ₂   | `Z = (X̄-Ȳ)/√(σ₁²/n₁+σ₂²/n₂)`                                 | N(0,1)        |
| **均值差 μ₁-μ₂**   | σ₁²=σ₂²=σ² 未知 | μ₁ = μ₂   | `T = (X̄-Ȳ)/(S_p√(1/n₁+1/n₂))`<br>`S_p² = [(n₁-1)S₁²+(n₂-1)S₂²]/(n₁+n₂-2)` | t(n₁+n₂-2)    |
| **方差比 σ₁²/σ₂²** | μ₁, μ₂ 未知     | σ₁² = σ₂² | `F = S₁²/S₂²`                                                | F(n₁-1, n₂-1) |

**拒绝域**：

- 均值差（双侧）：`|Z| ≥ z_{α/2}` 或 `|T| ≥ t_{α/2}(df)`。
- 方差比（双侧）：`F ≤ F_{1-α/2}(n₁-1, n₂-1)` 或 `F ≥ F_{α/2}(n₁-1, n₂-1)`。常用上侧分位数关系简化。

### **6. 非正态总体或大样本情形**

- **均值检验（大样本）**：由中心极限定理，用 `Z = (X̄ - μ₀)/(S/√n) ≈ N(0,1)`。
- **比例检验（0-1分布）**：检验 `H₀: p = p₀`。大样本下，
    \[
    Z = \frac{\hat{p} - p_0}{\sqrt{p_0(1-p_0)/n}} \stackrel{\text{近似}}{\sim} N(0,1)。
    \]
    （注意分母用 `p₀`，不是 `p̂`，这是在 H₀ 成立下的标准误。）

---

## **三、 重点题型与解题套路**

### **题型1：单个正态总体均值的检验**

- **识别**：方差是否已知？选择 Z 检验还是 t 检验。
- **注意**：t 检验要求总体正态，若只是近似正态且 n 较大，也可用 Z 近似。
- **步骤**：
    1. 设 H₀: μ = μ₀， H₁: μ ≠ μ₀（或 >, <）。
    2. 计算检验统计量观测值。
    3. 查表得临界值，或计算 P 值。
    4. 决策并结论。

### **题型2：单个正态总体方差的检验**

- **识别**：均值是否已知？选择不同的 χ² 统计量。
- **注意**：拒绝域不对称，查 χ² 分位数时注意上侧定义。
- **步骤**：类似均值检验，但统计量和分布不同。

### **题型3：两个正态总体均值差的检验**

- **关键**：判断两总体方差是否相等。
    - 若已知相等，用 pooled t 检验。
    - 若未知是否相等，可先做**方差齐性检验（F 检验）**，再决定用哪种 t 检验。
    - 若方差不等且未知，可用**近似 t 检验（Welch's t）**，自由度用近似公式。

### **题型4：P 值计算与决策**

- **P 值计算**：
    - 双侧检验：P = 2 × P(检验统计量 ≥ |观测值|) （对称分布）。
    - 右侧检验：P = P(检验统计量 ≥ 观测值)。
    - 左侧检验：P = P(检验统计量 ≤ 观测值)。
- **决策**：P ≤ α → 拒绝 H₀。

### **题型5：假设检验与置信区间的关系（重要）**

- 对于**双侧检验**，假设检验与置信区间是等价的：
    - 在 α 水平下拒绝 H₀: θ = θ₀ ⇔ θ₀ 不在 θ 的 1-α 置信区间内。
- 例如：μ 的 95% 置信区间为 (a, b)，则检验 H₀: μ = μ₀ 在 α=0.05 水平下的决策是：若 μ₀ ∉ (a, b)，则拒绝 H₀。

---

## **四、 易错点与注意事项**

1.  **H₀ 和 H₁ 的设立**：H₀ 必须包含等号（=， ≤， ≥）。等号永远在 H₀ 中。
2.  **结论的表述**：统计结论是“拒绝 H₀”或“不拒绝 H₀”，**不能说“接受 H₀”**。不拒绝只是证据不足，并非证明 H₀ 成立。
3.  **单侧 vs 双侧**：根据研究问题和备择假设确定。若只关心是否不同，用双侧；若关心是否大于或小于，用单侧。**单侧检验的拒绝域更易拒绝 H₀**（因为 α 全部放在一侧）。
4.  **检验统计量的选择**：严格根据条件（方差已知/未知，单样本/两样本）选择。
5.  **P 值的解释**：P 值不是 H₀ 为真的概率，而是在 H₀ 下得到当前数据的“异常程度”。

---

## **五、 终极查漏清单**

1.  **概念**：第一类错误 α 和第二类错误 β 的关系是什么？在样本量固定时，一个减小另一个会如何？（此消彼长）
2.  **公式**：写出单个正态总体在方差未知时，检验 H₀: μ = μ₀ 的 t 统计量公式。
3.  **查表**：对于 t(10) 分布，若观测值 T = 2.5，右侧检验的 P 值是多少？（查表得 t_{0.025}(10)=2.228， t_{0.01}(10)=2.764，所以 P 值在 0.01 和 0.025 之间）
4.  **关系**：显著性水平 α = 0.05 的双侧检验，与 95% 置信区间有什么关系？（若 μ₀ 不在 95% CI 内，则拒绝 H₀: μ = μ₀）
5.  **计算**：从正态总体中抽 n=25， X̄=102， S=15。检验 H₀: μ=100 vs H₁: μ>100 (α=0.05)。
    - t = (102-100)/(15/5)=2/3≈0.667， t_{0.05}(24)=1.711， 0.667 < 1.711，不拒绝 H₀。
    - P 值 = P(t(24) > 0.667) > 0.25，远大于 0.05。

**重要练习**：
设总体 X ~ N(μ, σ²)， σ² 未知。现有样本 n=16， X̄=21.5， S=2.4。在 α=0.05 下检验：

1.  H₀: μ=20 vs H₁: μ≠20（双侧）。
2.  H₀: μ≥22 vs H₁: μ<22（左侧）。
    并求第1问的P值。

**建议**：现在，请你合上眼，在纸上默写出**单个正态总体均值检验（Z检验、t检验）和方差检验（χ²检验）的统计量公式及拒绝域形式**，以及**P值的定义和决策规则**。然后，找一道同时要求用临界值法和P值法解题的题目，完整地做一遍。这是假设检验部分的核心技能。