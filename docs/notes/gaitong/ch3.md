# 二维随机变量及其分布

好的，现在我们进入**二维随机变量及其分布**。这部分是概率论从“单变量”到“多变量”的关键拓展，也是理解随机变量间关系、学习后续数理统计中样本联合分布的基础。

---

## 一、 核心逻辑与知识地图

**核心思想：** 研究**两个或多个**随机变量作为一个整体的统计规律，以及它们之间的相互关系。

**逻辑主线：**
**二维随机变量(X, Y)** → **联合分布函数F(x, y)** （核心纽带）→ **具体类型**

*   **离散型**：用**联合分布律**描述
*   **连续型**：用**联合概率密度函数f(x, y)** 描述
*   **关键衍生**：**边缘分布**（单个变量的分布）、**条件分布**（已知一个变量时另一个的分布）
*   **核心关系**：**独立性**（最重要的简化条件）
*   **综合应用**：求**Z=g(X, Y)**的分布（卷积公式等）

---

## **二、 核心知识点精讲与易错点**

### **1. 二维随机变量与联合分布函数**

- **联合分布函数（统一描述工具）**：
    `F(x, y) = P{X ≤ x, Y ≤ y}`， 表示随机点`(X, Y)`落在以`(x, y)`为顶点的**无穷矩形区域**内的概率。
- **四大性质（判定函数F(x,y)是否为联合分布函数的充要条件）**：
    1.  **单调性**：关于每个变量单调不减。
    2.  **规范性**：
        - `F(-∞, y) = lim_{x→-∞} F(x, y) = 0`
        - `F(x, -∞) = 0`
        - `F(+∞, +∞) = 1`
    3.  **右连续性**：关于每个变量都是右连续的。
    4.  **非负性**：对任意`a<b, c<d`，有
        `P{a<X≤b, c<Y≤d} = F(b,d) - F(a,d) - F(b,c) + F(a,c) ≥ 0`
        **这是二维独有的重要性质，体现了概率的非负性。**

### **2. 二维离散型随机变量**

- **描述工具：联合分布律**：
    `P{X = x_i, Y = y_j} = p_{ij}`， `i, j = 1, 2, ...`
    **性质**：`p_{ij} ≥ 0`，且 `∑_i ∑_j p_{ij} = 1`。
- **边缘分布律**：
    - `P{X = x_i} = p_{i·} = ∑_j p_{ij}` （对j求和，即表格的**行和**）
    - `P{Y = y_j} = p_{·j} = ∑_i p_{ij}` （对i求和，即表格的**列和**）
        **易错点**：边缘分布是一维分布，需满足一维分布律的性质。
- **条件分布律**（在已知一个变量取值条件下，另一个变量的分布）：
    - `P{X = x_i | Y = y_j} = p_{ij} / p_{·j}`， 要求 `p_{·j} > 0`
    - `P{Y = y_j | X = x_i} = p_{ij} / p_{i·}`， 要求 `p_{i·} > 0`

### **3. 二维连续型随机变量**

- **描述工具：联合概率密度函数f(x, y)**
    - **定义**：存在非负可积函数`f(x, y)`，使得 `F(x, y) = ∫_{-∞}^{x} ∫_{-∞}^{y} f(u, v) dv du`
    - **性质**：
        1.  `f(x, y) ≥ 0`
        2.  `∫_{-∞}^{+∞} ∫_{-∞}^{+∞} f(x, y) dx dy = 1` （归一性）
        3.  **几何意义**：概率是**曲面下的体积**。
            `P{(X, Y) ∈ D} = ∬_{D} f(x, y) dx dy`
- **边缘概率密度**：
    - `f_X(x) = ∫_{-∞}^{+∞} f(x, y) dy`
    - `f_Y(y) = ∫_{-∞}^{+∞} f(x, y) dx`
        **几何意义**：联合密度曲面在`x`（或`y`）方向的“投影”。
- **条件概率密度**（核心且易错）：
    - `f_{X|Y}(x | y) = f(x, y) / f_Y(y)`， 要求 `f_Y(y) > 0`
    - `f_{Y|X}(y | x) = f(x, y) / f_X(x)`， 要求 `f_X(x) > 0`
        **重要理解**：对于固定的`y`，`f_{X|Y}(x | y)`是**关于`x`的一元概率密度函数**，满足归一性：`∫ f_{X|Y}(x|y) dx = 1`。
- **常见二维连续分布**：
    - **二维均匀分布**：密度在区域`D`上为常数`1/|D|`（`|D|`为区域面积）。
    - **二维正态分布**：`(X, Y) ~ N(μ1, μ2, σ1², σ2², ρ)`。参数`ρ`是相关系数。它的边缘分布仍为正态：`X~N(μ1, σ1²)`， `Y~N(μ2, σ2²)`。

### **4. 随机变量的独立性（二维部分的核心）**

- **定义**：事件`{X≤x}`与`{Y≤y}`独立，对一切`x, y`。
- **等价条件（必须熟记，用于判断和简化计算）**：
    1.  **分布函数形式**：`F(x, y) = F_X(x) F_Y(y)`
    2.  **离散型**：`p_{ij} = p_{i·} * p_{·j}` （对所有`i, j`）
    3.  **连续型**：`f(x, y) = f_X(x) f_Y(y)` （在一切连续点上）
    4.  **条件分布等于边缘分布**（连续型为例）：`f_{X|Y}(x|y) = f_X(x)`
- **易错点**：
    - **独立性的判定必须严格用上述公式**，不能凭感觉。
    - 对于二维正态分布，`X`与`Y`独立 **⇔** 相关系数`ρ = 0`。这是一个特例。

### **5. 二维随机变量函数的分布（难点）**

这里主要研究 `Z = g(X, Y)` 的分布。主要有三种方法：

1.  **分布函数法（万能通法，尤其适合非单调、分段、区域复杂情况）**：
    - **步骤**：
        ① `F_Z(z) = P{Z ≤ z} = P{g(X, Y) ≤ z} = P{(X, Y) ∈ D_z}`，其中 `D_z = {(x, y) | g(x, y) ≤ z}`。
        ② 计算概率 `∬_{D_z} f(x, y) dx dy`。
        ③ 对 `z` 求导得到密度 `f_Z(z)`。
    - **关键**：正确画出积分区域 `D_z` 并确定积分上下限。

2.  **卷积公式（特定但高频）**：
    - **适用场景**：`Z = X + Y`，且 `X` 与 `Y` **独立**。
    - **公式**：
        - 连续型：`f_Z(z) = ∫_{-∞}^{+∞} f_X(x) f_Y(z - x) dx` 或 `= ∫_{-∞}^{+∞} f_X(z - y) f_Y(y) dy`
        - 离散型：`P{Z = k} = ∑_i P{X = i} P{Y = k - i}`
    - **记忆口诀**：“其中一个固定，另一个用和减去它”。

3.  **特殊公式**：
    - `Z = max(X, Y)`：`F_{max}(z) = F_X(z) * F_Y(z)` （要求独立）
    - `Z = min(X, Y)`：`F_{min}(z) = 1 - [1 - F_X(z)][1 - F_Y(z)]` （要求独立）
    - `Z = X/Y`， `Z = XY` 等：可用分布函数法推导，有时有现成公式但易混，**建议掌握分布函数法**。

---

## **三、 重点题型与解题套路**

1.  **已知联合分布，求边缘分布和条件分布**：
    - **离散型**：列表，求和，做除法。
    - **连续型**：积分求边缘密度，做除法求条件密度。**注意定义域**（条件密度中，分母>0的区域才有效）。

2.  **判断独立性**：
    - **第一步**：求出边缘分布 `f_X(x)` 和 `f_Y(y)`。
    - **第二步**：检验 `f(x, y) = f_X(x) f_Y(y)` 是否**处处成立**（或离散型检验 `p_{ij}=p_i*p_j`）。
    - **常见错误**：只验证了一个点或一个形式就下结论。

3.  **已知联合密度，求概率 `P{(X,Y)∈D}`**：
    - 画出区域 `D`。
    - 确定积分次序和上下限（可能需要分区域讨论）。
    - 计算二重积分。

4.  **求随机变量函数的分布 `Z=g(X,Y)`**：
    - 首选**分布函数法**。
    - 如果明确是 `Z=X+Y` 且独立，直接用**卷积公式**。
    - 如果明确是 `Z=max/min` 且独立，用最大最小值公式。

5.  **综合题**：结合独立性、条件分布、函数分布进行考查。

---

## **四、 终极查漏清单**

1.  **概念**：联合分布函数 `F(x,y)` 的几何意义是什么？`F_X(x)` 与 `F(x, +∞)` 是什么关系？
2.  **计算**：已知 `f(x,y)` 在某个矩形区域外为0，如何求 `f_X(x)`？ （答案：对 `y` 积分，但积分限由 `f(x,y)` 非零的 `y` 范围决定）
3.  **辨析**：若 `f(x,y) = g(x)h(y)`， `X` 和 `Y` 一定独立吗？（不一定，还需满足归一化条件。但若 `g` 和 `h` 本身是概率密度，且 `f(x,y)` 就是联合密度，则独立。）
4.  **应用**：如何用分布函数法求 `Z=X/Y` 的密度？（提示：`{X/Y ≤ z}` 的区域需分 `y>0` 和 `y<0` 讨论）
5.  **联系**：二维正态分布中，参数 `ρ` 的几何意义是什么？`ρ=0` 意味着什么？

**一个重要的综合练习**：
设 `(X,Y)` 在由 `y=x`, `y=0`, `x=1` 围成的三角形区域上服从均匀分布。

1.  求联合密度 `f(x,y)` 和边缘密度 `f_X(x)`。
2.  判断 `X` 与 `Y` 是否独立。
3.  求条件密度 `f_{X|Y}(x|y)`。
4.  求 `Z=X+Y` 的概率密度。

**建议**：现在，请你合上眼，在纸上默写出**联合分布函数性质、边缘与条件密度的关系、独立性的三个等价条件、卷积公式**。然后，找一道包含上述综合练习所有步骤的题目，完整地做一遍。这是将二维随机变量知识融会贯通的最佳途径。